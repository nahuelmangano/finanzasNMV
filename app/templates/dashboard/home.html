
{% extends "base.html" %}
{% block title %}Dashboard - Gastos{% endblock %}
{% block content %}
<div class="row g-3">
  <div class="col-12 col-lg-4">
    <div class="card h-100">
      <div class="card-body">
        <h2 class="h6 text-muted">Total del mes</h2>
        <div class="display-6 fw-bold">$ {{ '%.2f'|format(month_total) }}</div>
        <p class="text-secondary mb-0 small">Suma de todos los gastos desde el 1° del mes.</p>
      </div>
    </div>
  </div>
  <div class="col-12 col-lg-8">
    <div class="card h-100">
      <div class="card-body">
        <h2 class="h6 text-muted mb-3">Gasto por categoría (mes)</h2>
        <canvas id="pieCats"></canvas>
      </div>
    </div>
  </div>
  <div class="col-12">
    <div class="card">
      <div class="card-body">
        <h2 class="h6 text-muted mb-3">Últimos 6 meses</h2>
        <canvas id="lineTrend"></canvas>
      </div>
    </div>
  </div>
</div>

<script>
const catLabels = {{ cat_labels|tojson }};
const catValues = {{ cat_values|tojson }};
const trendLabels = {{ trend_labels|tojson }};
const trendValues = {{ trend_values|tojson }};

new Chart(document.getElementById('pieCats'), {
  type: 'pie',
  data: { labels: catLabels, datasets: [{ data: catValues }] },
  options: { responsive: true, plugins: { legend: { position: 'bottom' } } }
});

new Chart(document.getElementById('lineTrend'), {
  type: 'line',
  data: { labels: trendLabels, datasets: [{ label: 'Total mensual', data: trendValues, tension: 0.3 }] },
  options: { responsive: true, plugins: { legend: { display: true } }, scales: { y: { beginAtZero: true } } }
});
</script>
{% endblock %}
